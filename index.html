<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Coda Tab Bar</title>
<style>
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                 Helvetica, Arial, sans-serif;
    background: transparent;
    overflow: hidden;
  }

  .bar {
    display: flex;
    flex-wrap: nowrap;
    align-items: flex-end;
    gap: 2px;
    padding: 4px 8px 0;
    border-bottom: 2px solid #dadce0;
    overflow-x: auto;
    scrollbar-width: none;          /* Firefox */
  }
  .bar::-webkit-scrollbar { display: none; }  /* Chrome / Safari */

  .tab {
    display: inline-flex;
    align-items: center;
    padding: 8px 18px;
    border-radius: 10px 10px 0 0;
    text-decoration: none;
    font-size: 13px;
    font-weight: 400;
    color: #5f6368;
    background: #f1f3f4;
    white-space: nowrap;
    transition: background 0.15s, color 0.15s, box-shadow 0.15s;
    border: 1px solid transparent;
    border-bottom: none;
    margin-bottom: -2px;
    cursor: pointer;
    user-select: none;
  }

  .tab:hover {
    background: #e8f0fe;
    color: #1a73e8;
  }

  .tab.active {
    background: #fff;
    color: #1a73e8;
    font-weight: 600;
    border-color: #dadce0;
    box-shadow: 0 -2px 6px rgba(0,0,0,0.06);
  }

  .tab.active:hover {
    background: #fff;
  }

  /* Error / empty state */
  .error {
    padding: 12px 16px;
    color: #d93025;
    font-size: 13px;
  }
</style>
</head>
<body>

<div id="bar" class="bar"></div>

<script>
(function () {
  var bar = document.getElementById("bar");

  // Read base64-encoded JSON from ?d= query parameter
  var params = new URLSearchParams(window.location.search);
  var encoded = params.get("d");

  if (!encoded) {
    bar.innerHTML = '<span class="error">No tab data provided.</span>';
    return;
  }

  var tabs;
  try {
    tabs = JSON.parse(atob(encoded));
  } catch (e) {
    bar.innerHTML = '<span class="error">Invalid tab data.</span>';
    return;
  }

  if (!Array.isArray(tabs) || tabs.length === 0) {
    bar.innerHTML = '<span class="error">No tabs found.</span>';
    return;
  }

  tabs.forEach(function (t) {
    var a = document.createElement("a");
    a.className = "tab" + (t.active ? " active" : "");
    a.href = t.link || "#";
    a.target = "_top";          // navigate the parent Coda page
    a.textContent = t.name || "Untitled";
    bar.appendChild(a);
  });
})();
</script>

</body>
</html>